{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 16, "column": 0}, "map": {"version":3,"sources":["file:///Users/amrassal/Documents/Git-Projects/AtlasEgypt/helper/db-util.js"],"sourcesContent":["import { MongoClient } from \"mongodb\";\n\nexport function connectDatabase() {\n  const client = MongoClient.connect(\n    \"mongodb+srv://amrkhaledassal:AkA1292003@cluster0.bozkfl7.mongodb.net/AtlasEgypt?retryWrites=true&w=majority\",\n  );\n  return client;\n}\n\nexport async function InsertDocument(client, document, collection) {\n  const db = client.db();\n  const result = db.collection(collection).insertOne(document);\n  return result;\n}\n"],"names":[],"mappings":";;;;;;AAAA;;AAEO,SAAS;IACd,MAAM,SAAS,kNAAW,CAAC,OAAO,CAChC;IAEF,OAAO;AACT;AAEO,eAAe,eAAe,MAAM,EAAE,QAAQ,EAAE,UAAU;IAC/D,MAAM,KAAK,OAAO,EAAE;IACpB,MAAM,SAAS,GAAG,UAAU,CAAC,YAAY,SAAS,CAAC;IACnD,OAAO;AACT"}},
    {"offset": {"line": 39, "column": 0}, "map": {"version":3,"sources":["file:///Users/amrassal/Documents/Git-Projects/AtlasEgypt/helper/hash-Password.js"],"sourcesContent":["import {hash, compare} from 'bcryptjs'\n\nexport async function hashPassword(password){\n    const hashedPassword = await hash(password, 12);\n    return hashedPassword;\n}\n\nexport async function verifyPassword(password, hashedPassword){\n    const isValid = await compare(password, hashedPassword);\n    return isValid;\n}"],"names":[],"mappings":";;;;;;AAAA;;;;;;AAEO,eAAe,aAAa,QAAQ;IACvC,MAAM,iBAAiB,MAAM,IAAA,qNAAI,EAAC,UAAU;IAC5C,OAAO;AACX;AAEO,eAAe,eAAe,QAAQ,EAAE,cAAc;IACzD,MAAM,UAAU,MAAM,IAAA,wNAAO,EAAC,UAAU;IACxC,OAAO;AACX"}},
    {"offset": {"line": 66, "column": 0}, "map": {"version":3,"sources":["file:///Users/amrassal/Documents/Git-Projects/AtlasEgypt/pages/api/auth/%5B...nextauth%5D.js"],"sourcesContent":["import NextAuth from \"next-auth\";\nimport CredentialsProvider from \"next-auth/providers/credentials\";\nimport { connectDatabase } from \"@/helper/db-util\";\nimport { verifyPassword } from \"@/helper/hash-Password\";\n\nexport const authOptions = {\n  secret: process.env.NEXTAUTH_SECRET || \"fallback-secret-for-development-only\",\n  session: {\n    strategy: \"jwt\",\n  },\n  providers: [\n    CredentialsProvider({\n      async authorize(credentials) {\n        const client = await connectDatabase();\n        const db = client.db();\n\n        const userCollection = db.collection(\"users\");\n        const user = await userCollection.findOne({ email: credentials.email });\n\n        if (!user) {\n          client.close();\n          throw new Error(\"No user found!\");\n        }\n\n        // You can add password verification logic here\n\n        const isValid = await verifyPassword(\n          credentials.password,\n          user.password,\n        );\n        if (!isValid) {\n          client.close();\n          throw new Error(\"Could not log you in!\");\n        }\n        client.close();\n        return { email: user.email };\n      },\n    }),\n  ],\n};\n\nexport default NextAuth(authOptions);\n"],"names":[],"mappings":";;;;;;AAAA;AACA;AACA;AACA;;;;;;;;;AAEO,MAAM,cAAc;IACzB,QAAQ,QAAQ,GAAG,CAAC,eAAe,IAAI;IACvC,SAAS;QACP,UAAU;IACZ;IACA,WAAW;QACT,IAAA,qRAAmB,EAAC;YAClB,MAAM,WAAU,WAAW;gBACzB,MAAM,SAAS,MAAM,IAAA,8KAAe;gBACpC,MAAM,KAAK,OAAO,EAAE;gBAEpB,MAAM,iBAAiB,GAAG,UAAU,CAAC;gBACrC,MAAM,OAAO,MAAM,eAAe,OAAO,CAAC;oBAAE,OAAO,YAAY,KAAK;gBAAC;gBAErE,IAAI,CAAC,MAAM;oBACT,OAAO,KAAK;oBACZ,MAAM,IAAI,MAAM;gBAClB;gBAEA,+CAA+C;gBAE/C,MAAM,UAAU,MAAM,IAAA,mLAAc,EAClC,YAAY,QAAQ,EACpB,KAAK,QAAQ;gBAEf,IAAI,CAAC,SAAS;oBACZ,OAAO,KAAK;oBACZ,MAAM,IAAI,MAAM;gBAClB;gBACA,OAAO,KAAK;gBACZ,OAAO;oBAAE,OAAO,KAAK,KAAK;gBAAC;YAC7B;QACF;KACD;AACH;uCAEe,IAAA,6NAAQ,EAAC"}}]
}