{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 16, "column": 0}, "map": {"version":3,"sources":["file:///Users/amrassal/Documents/Git-Projects/AtlasEgypt/helper/db-util.js"],"sourcesContent":["import { MongoClient } from \"mongodb\";\n\nexport function connectDatabase() {\n  const client = MongoClient.connect(\n    \"mongodb+srv://amrkhaledassal:AkA1292003@cluster0.bozkfl7.mongodb.net/AtlasEgypt?retryWrites=true&w=majority\",\n  );\n  return client;\n}\n\nexport async function InsertDocument(client, document, collection) {\n  const db = client.db();\n  const result = db.collection(collection).insertOne(document);\n  return result;\n}\n"],"names":[],"mappings":";;;;;;AAAA;;AAEO,SAAS;IACd,MAAM,SAAS,oKAAW,CAAC,OAAO,CAChC;IAEF,OAAO;AACT;AAEO,eAAe,eAAe,MAAM,EAAE,QAAQ,EAAE,UAAU;IAC/D,MAAM,KAAK,OAAO,EAAE;IACpB,MAAM,SAAS,GAAG,UAAU,CAAC,YAAY,SAAS,CAAC;IACnD,OAAO;AACT"}},
    {"offset": {"line": 39, "column": 0}, "map": {"version":3,"sources":["file:///Users/amrassal/Documents/Git-Projects/AtlasEgypt/helper/hash-Password.js"],"sourcesContent":["import {hash, compare} from 'bcryptjs'\n\nexport async function hashPassword(password){\n    const hashedPassword = await hash(password, 12);\n    return hashedPassword;\n}\n\nexport async function verifyPassword(password, hashedPassword){\n    const isValid = await compare(password, hashedPassword);\n    return isValid;\n}"],"names":[],"mappings":";;;;;;AAAA;;;;;;AAEO,eAAe,aAAa,QAAQ;IACvC,MAAM,iBAAiB,MAAM,IAAA,uKAAI,EAAC,UAAU;IAC5C,OAAO;AACX;AAEO,eAAe,eAAe,QAAQ,EAAE,cAAc;IACzD,MAAM,UAAU,MAAM,IAAA,0KAAO,EAAC,UAAU;IACxC,OAAO;AACX"}},
    {"offset": {"line": 66, "column": 0}, "map": {"version":3,"sources":["file:///Users/amrassal/Documents/Git-Projects/AtlasEgypt/pages/api/auth/signup.js"],"sourcesContent":["import { connectDatabase, InsertDocument } from \"@/helper/db-util\";\nimport { hashPassword } from \"@/helper/hash-Password\";\n\nasync function handler(req, res) {\n  if (req.method === \"POST\") {\n    const { name, email, password } = req.body;\n    if (\n      !name ||\n      name.trim() === \"\" ||\n      !email ||\n      !email.includes(\"@\") ||\n      !password ||\n      password.trim().length < 7\n    ) {\n      res\n        .status(422)\n        .json({ message: \"Invalid input - please check your data.\" });\n      return;\n    }\n\n    let client;\n    try {\n      client = await connectDatabase();\n    } catch (error) {\n      res.status(500).json({ message: \"Could not connect to database.\" });\n      return;\n    }\n    \n    const db = client.db();\n    const existingUser = await db.collection(\"users\").findOne({ email: email });\n\n    if (existingUser) {\n        res.status(422).json({ message: \"User already exists!\" });\n        client.close();\n        return;\n    }\n\n    const hashedPassword = await hashPassword(password);\n    const newUser = {\n      name: name,\n      email: email,\n      password: hashedPassword,\n    };\n    \n\n    try {\n      client = await InsertDocument(client, newUser, \"users\");\n    } catch (error) {\n      client.close();\n      res.status(500).json({ message: \"Adding user failed!\" });\n      return;\n    }\n\n    res.status(201).json({ message: \"User Created successfully!\" });\n    client.close();\n  }\n}\n\nexport default handler;\n"],"names":[],"mappings":";;;;AAAA;AACA;;;;;;;AAEA,eAAe,QAAQ,GAAG,EAAE,GAAG;IAC7B,IAAI,IAAI,MAAM,KAAK,QAAQ;QACzB,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,QAAQ,EAAE,GAAG,IAAI,IAAI;QAC1C,IACE,CAAC,QACD,KAAK,IAAI,OAAO,MAChB,CAAC,SACD,CAAC,MAAM,QAAQ,CAAC,QAChB,CAAC,YACD,SAAS,IAAI,GAAG,MAAM,GAAG,GACzB;YACA,IACG,MAAM,CAAC,KACP,IAAI,CAAC;gBAAE,SAAS;YAA0C;YAC7D;QACF;QAEA,IAAI;QACJ,IAAI;YACF,SAAS,MAAM,IAAA,gIAAe;QAChC,EAAE,OAAO,OAAO;YACd,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;gBAAE,SAAS;YAAiC;YACjE;QACF;QAEA,MAAM,KAAK,OAAO,EAAE;QACpB,MAAM,eAAe,MAAM,GAAG,UAAU,CAAC,SAAS,OAAO,CAAC;YAAE,OAAO;QAAM;QAEzE,IAAI,cAAc;YACd,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;gBAAE,SAAS;YAAuB;YACvD,OAAO,KAAK;YACZ;QACJ;QAEA,MAAM,iBAAiB,MAAM,IAAA,mIAAY,EAAC;QAC1C,MAAM,UAAU;YACd,MAAM;YACN,OAAO;YACP,UAAU;QACZ;QAGA,IAAI;YACF,SAAS,MAAM,IAAA,+HAAc,EAAC,QAAQ,SAAS;QACjD,EAAE,OAAO,OAAO;YACd,OAAO,KAAK;YACZ,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;gBAAE,SAAS;YAAsB;YACtD;QACF;QAEA,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;YAAE,SAAS;QAA6B;QAC7D,OAAO,KAAK;IACd;AACF;uCAEe"}}]
}