{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 18, "column": 0}, "map": {"version":3,"sources":["file:///Users/amrassal/Documents/Git-Projects/AtlasEgypt/helper/hash-Password.js"],"sourcesContent":["import {hash, compare} from 'bcryptjs'\n\nexport async function hashPassword(password){\n    const hashedPassword = await hash(password, 12);\n    return hashedPassword;\n}\n\nexport async function verifyPassword(password, hashedPassword){\n    const isValid = await compare(password, hashedPassword);\n    return isValid;\n}"],"names":[],"mappings":";;;;;;AAAA;;;;;;AAEO,eAAe,aAAa,QAAQ;IACvC,MAAM,iBAAiB,MAAM,IAAA,uKAAI,EAAC,UAAU;IAC5C,OAAO;AACX;AAEO,eAAe,eAAe,QAAQ,EAAE,cAAc;IACzD,MAAM,UAAU,MAAM,IAAA,0KAAO,EAAC,UAAU;IACxC,OAAO;AACX"}},
    {"offset": {"line": 45, "column": 0}, "map": {"version":3,"sources":["file:///Users/amrassal/Documents/Git-Projects/AtlasEgypt/pages/api/auth/%5B...nextauth%5D.js"],"sourcesContent":["import NextAuth from \"next-auth\";\nimport CredentialsProvider from \"next-auth/providers/credentials\";\nimport { connectedDatabase } from \"../../../helper/db\";\nimport { verifyPassword } from \"@/helper/hash-Password\";\n\nexport default NextAuth({\n  session: {\n    strategy: \"jwt\",\n  },\n  providers: [\n    CredentialsProvider({\n      async authorize(Credentials) {\n        const client = await connectedDatabase();\n        const db = client.db();\n\n        const userCollection = db.collection(\"users\");\n        const user = await userCollection.findOne({ email: Credentials.email });\n\n        if (!user) {\n          client.close();\n          throw new Error(\"No user found!\");\n        }\n        client.close();\n\n        // You can add password verification logic here\n\n        const isValid = await verifyPassword(\n          Credentials.password,\n          user.password,\n        );\n        if (!isValid) {\n          client.close();\n          throw new Error(\"Could not log you in!\");\n        }\n        client.close();\n        return { email: user.email };\n      },\n    }),\n  ],\n});\n"],"names":[],"mappings":";;;;AAAA;AACA;;;;;;AAEA;;;;;;;;;uCAEe,IAAA,+KAAQ,EAAC;IACtB,SAAS;QACP,UAAU;IACZ;IACA,WAAW;QACT,IAAA,uOAAmB,EAAC;YAClB,MAAM,WAAU,WAAW;gBACzB,MAAM,SAAS,MAAM;gBACrB,MAAM,KAAK,OAAO,EAAE;gBAEpB,MAAM,iBAAiB,GAAG,UAAU,CAAC;gBACrC,MAAM,OAAO,MAAM,eAAe,OAAO,CAAC;oBAAE,OAAO,YAAY,KAAK;gBAAC;gBAErE,IAAI,CAAC,MAAM;oBACT,OAAO,KAAK;oBACZ,MAAM,IAAI,MAAM;gBAClB;gBACA,OAAO,KAAK;gBAEZ,+CAA+C;gBAE/C,MAAM,UAAU,MAAM,IAAA,qIAAc,EAClC,YAAY,QAAQ,EACpB,KAAK,QAAQ;gBAEf,IAAI,CAAC,SAAS;oBACZ,OAAO,KAAK;oBACZ,MAAM,IAAI,MAAM;gBAClB;gBACA,OAAO,KAAK;gBACZ,OAAO;oBAAE,OAAO,KAAK,KAAK;gBAAC;YAC7B;QACF;KACD;AACH"}}]
}