{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 16, "column": 0}, "map": {"version":3,"sources":["file:///Users/amrassal/Documents/Git-Projects/AtlasEgypt/pages/api/newsletter.js"],"sourcesContent":["import { MongoClient } from \"mongodb\";\n\nfunction connectDatabase(){\n    const client = MongoClient.connect(\"mongodb+srv://amrkhaledassal:AkA1292003@cluster0.bozkfl7.mongodb.net/AtlasEgypt?retryWrites=true&w=majority\");\n    return client;\n}\n\nfunction InsertDocument(client, document){\n    const db = client.db();\n    const newsletterCollection = db.collection(\"newsletterEmails\");\n    return newsletterCollection.insertOne(document);\n}\n\n\nasync function handler(req,res){\n    const enteredEmail = req.body.email;\n    if(!enteredEmail || !enteredEmail.includes('@')){\n        res.status(422).json({message: \"Invalid email address.\"})\n        return;\n    }\n\n    if(req.method === \"POST\"){\n      let client;\n      try{\n        client = await connectDatabase();\n      }catch(error){\n        res.status(500).json({message: \"Could not connect to database.\"});\n      }\n        try{\n            await InsertDocument(client, {email: enteredEmail});\n            res.status(201).json({message: \"Signed up successfully!\"});\n            client.close();\n        }catch(error){\n            res.status(500).json({message: \"Inserting data failed!\"});\n            return;\n        }\n        res.status(201).json({message: \"singed up successfully!\", email: enteredEmail});\n    }\n}\n\nexport default handler;"],"names":[],"mappings":";;;;AAAA;;AAEA,SAAS;IACL,MAAM,SAAS,oKAAW,CAAC,OAAO,CAAC;IACnC,OAAO;AACX;AAEA,SAAS,eAAe,MAAM,EAAE,QAAQ;IACpC,MAAM,KAAK,OAAO,EAAE;IACpB,MAAM,uBAAuB,GAAG,UAAU,CAAC;IAC3C,OAAO,qBAAqB,SAAS,CAAC;AAC1C;AAGA,eAAe,QAAQ,GAAG,EAAC,GAAG;IAC1B,MAAM,eAAe,IAAI,IAAI,CAAC,KAAK;IACnC,IAAG,CAAC,gBAAgB,CAAC,aAAa,QAAQ,CAAC,MAAK;QAC5C,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;YAAC,SAAS;QAAwB;QACvD;IACJ;IAEA,IAAG,IAAI,MAAM,KAAK,QAAO;QACvB,IAAI;QACJ,IAAG;YACD,SAAS,MAAM;QACjB,EAAC,OAAM,OAAM;YACX,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;gBAAC,SAAS;YAAgC;QACjE;QACE,IAAG;YACC,MAAM,eAAe,QAAQ;gBAAC,OAAO;YAAY;YACjD,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;gBAAC,SAAS;YAAyB;YACxD,OAAO,KAAK;QAChB,EAAC,OAAM,OAAM;YACT,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;gBAAC,SAAS;YAAwB;YACvD;QACJ;QACA,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;YAAC,SAAS;YAA2B,OAAO;QAAY;IACjF;AACJ;uCAEe"}}]
}